--- 开始下载 ----
下载进度 : 20.0%
下载进度 : 40.0%
下载进度 : 60.0%
下载进度 : 80.0%
下载进度 : 100.0%
DataFrame 的大小:  (114845, 8)
成功添加技术指标
对当前时间段未上市的公司的所有行置零
         date  ... close_120_sma
0  2009-01-05  ...        2.8013
0  2009-01-05  ...        9.5836
0  2009-01-05  ...        1.6448
0  2009-01-05  ...        3.2371
0  2009-01-05  ...        9.5502

[5 rows x 17 columns]
stock_dimension: 50, state_space: 551
observation:  [947261.8693053996, 3.2587, 10.5955, 1.7518, 3.5118, 10.5073, 3.3248, 6.5186, 3.1604, 4.427, 2.8512, 6.5327, 3.5638, 5.4781, 63.1248, 5.7194, 3.4616, 7.31, 2.9807, 1.8566, 0.9691, 0.0, 8.7087, 1.2094, 0.0, 0.0, 0.0, 10.8021, 0.0, 4.274, 7.8589, 0.0, 0.0, 0.0, 12.5139, 0.0, 0.0, 2.028, 10.5996, 16.7811, 0.0, 0.0, 0.0, 0.0, 7.7493, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45, 25, 54, 405, 141, 224, 25, 30, 232, 308, 148, 277, 70, 467, 21, 0, 56, 268, 83, 160, 229, 229, 0, 0, 0, 0, 0, 0, 241, 204, 0, 0, 0, 191, 0, 0, 0, 277, 157, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.03743618918699809, 0.06953890696683374, 0.007677886848015625, 0.016639777403863132, 0.0833996414922904, 0.04104215954933066, 0.029356228407619867, 0.017829987607546727, -0.019569687238604416, 0.012589765298079314, 0.031200231681522084, -0.00610624830655393, 0.06264932622851216, -0.4342902998632141, -0.02738007874586934, 0.061589775935440016, -0.020204455734774918, 0.00760392665578058, -0.0003282069073724525, 0.00909305575523045, 0.0, 0.14361499931314814, 0.006945811559547099, 0.0, 0.0, 0.0, 0.008561235911646037, 0.0, 0.06469209773067774, -0.03179709816144438, 0.0, 0.0, 0.0, 0.042040964144996806, 0.0, 0.0, -0.00024513138880011276, 0.12765837809514302, 0.03488679776926418, 0.0, 0.0, 0.0, 0.0, 0.003032750870093359, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.29030605610415, 11.158052250161413, 1.7506966619148174, 3.4629588940085694, 10.615014793023931, 3.4648652199996115, 6.567314521607222, 3.175544225375469, 4.771290487123888, 2.944647651106249, 6.705733731264593, 3.693131267631593, 5.698170639583509, 68.74835077321057, 6.15819869140558, 3.600371485962766, 7.7084983780785885, 3.0302467355334706, 1.9052412830693457, 1.0368484735782546, 0.0, 9.029770434991562, 1.2332554839997247, 0.0, 0.0, 0.0, 11.065726567810632, 0.0, 4.342549802108252, 8.427063302633073, 0.0, 0.0, 0.0, 12.753178351924353, 0.0, 0.0, 2.048496687661143, 10.893299117659073, 16.97337449709229, 0.0, 0.0, 0.0, 0.0, 7.831771654884897, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.6616575802594857, 9.567620477111317, 1.5813942471760913, 3.0792229241732483, 9.082948843339707, 2.7117165981822073, 5.720467296574598, 2.7618012291699854, 4.084469512876112, 2.6465159852573863, 6.0627753596445, 3.518723277822953, 4.615865724052853, 60.56786740860761, 5.3360194904126015, 2.60839215040087, 6.978501621921411, 2.791135082648349, 1.7458314442033813, 0.8424424355126544, 0.0, 6.647447746826616, 1.1075808796366389, 0.0, 0.0, 0.0, 10.022382523098457, 0.0, 3.299050197891748, 7.702856697366929, 0.0, 0.0, 0.0, 11.24491255716656, 0.0, 0.0, 1.8973396759752204, 8.563940882340926, 15.373807321089526, 0.0, 0.0, 0.0, 0.0, 7.257646526933285, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 76.03339630703236, 68.40717977033304, 68.07350263443388, 73.41926550600668, 71.23585726984106, 76.85323416009308, 62.77611632146706, 69.83413488205979, 44.3300320981869, 68.7061989091207, 57.49606723557604, 31.971277903508508, 87.81338524343636, 31.02203881193637, 35.85485745128149, 78.06983280306508, 52.715246795088945, 54.563785319560424, 51.6346311921877, 69.07815848569717, 0.0, 78.17466769246536, 70.30863292043847, 0.0, 0.0, 0.0, 61.81051563929317, 0.0, 83.44131497796627, 27.911732566834743, 0.0, 0.0, 0.0, 62.202162213985375, 0.0, 0.0, 56.786720941075494, 81.47256599806437, 59.500459098629115, 0.0, 0.0, 0.0, 0.0, 58.00329288152226, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 174.4215725060299, 78.36201325770573, 212.9373863844171, 228.1288822987211, 162.77522157048756, 126.48662496367571, 172.88397616027922, 189.45300149058164, 10.129192486006152, 75.38716493350479, 142.98883264532236, -105.44186702237387, 100.49222092307598, -58.49027418382711, 13.4125600043147, 144.863357985815, -14.234599262731043, 140.64419552986158, 49.650877221143844, 80.2060701823688, 0.0, 142.9349379483303, 136.3014727983175, 0.0, 0.0, 0.0, 108.11815586518422, 0.0, 163.43913461465692, -81.25771548907123, 0.0, 0.0, 0.0, 134.17026406727896, 0.0, 0.0, 129.90130571563785, 135.28168975237367, 155.28309020264842, 0.0, 0.0, 0.0, 0.0, 118.6873172717515, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 68.45426624783556, 67.51593864520234, 68.09437648217842, 58.8190752911434, 62.19642833082217, 84.59164175244662, 49.204776543238594, 37.53985550880191, 0.23011018453918997, 52.41927254988843, 60.50781731102457, 62.08262241882678, 80.09416173716416, 54.51025980783584, 10.30859205121814, 87.00663076865725, 31.245437253225383, 29.98820100065484, 7.331150975001931, 61.70314010147675, 0.0, 77.29523184027457, 82.8834795786765, 0.0, 0.0, 0.0, 34.84707605177154, 0.0, 64.75583823698744, 26.510997212093667, 0.0, 0.0, 0.0, 37.89711627601297, 0.0, 0.0, 40.57341533754719, 75.25326258811057, 39.31889179628177, 0.0, 0.0, 0.0, 0.0, 43.48874606163553, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.975981818181818, 10.362836363636365, 1.6660454545454544, 3.271090909090909, 9.84898181818182, 3.0882909090909094, 6.14389090909091, 2.968672727272727, 4.42788, 2.7955818181818177, 6.384254545454547, 3.605927272727273, 5.157018181818181, 64.6581090909091, 5.747109090909091, 3.104381818181818, 7.3435, 2.91069090909091, 1.8255363636363635, 0.9396454545454546, 0.0, 7.838609090909089, 1.1704181818181818, 0.0, 0.0, 0.0, 10.544054545454545, 0.0, 3.8208, 8.064960000000001, 0.0, 0.0, 0.0, 11.999045454545456, 0.0, 0.0, 1.9729181818181816, 9.72862, 16.17359090909091, 0.0, 0.0, 0.0, 0.0, 7.544709090909091, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.975981818181818, 10.362836363636365, 1.6660454545454544, 3.271090909090909, 9.84898181818182, 3.0882909090909094, 6.14389090909091, 2.968672727272727, 4.42788, 2.7955818181818177, 6.384254545454547, 3.605927272727273, 5.157018181818181, 64.6581090909091, 5.747109090909091, 3.104381818181818, 7.3435, 2.91069090909091, 1.8255363636363635, 0.9396454545454546, 0.0, 7.838609090909089, 1.1704181818181818, 0.0, 0.0, 0.0, 10.544054545454545, 0.0, 3.8208, 8.064960000000001, 0.0, 0.0, 0.0, 11.999045454545456, 0.0, 0.0, 1.9729181818181816, 9.72862, 16.17359090909091, 0.0, 0.0, 0.0, 0.0, 7.544709090909091, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.975981818181818, 10.362836363636365, 1.6660454545454544, 3.271090909090909, 9.84898181818182, 3.0882909090909094, 6.14389090909091, 2.968672727272727, 4.42788, 2.7955818181818177, 6.384254545454547, 3.605927272727273, 5.157018181818181, 64.6581090909091, 5.747109090909091, 3.104381818181818, 7.3435, 2.91069090909091, 1.8255363636363635, 0.9396454545454546, 0.0, 7.838609090909089, 1.1704181818181818, 0.0, 0.0, 0.0, 10.544054545454545, 0.0, 3.8208, 8.064960000000001, 0.0, 0.0, 0.0, 11.999045454545456, 0.0, 0.0, 1.9729181818181816, 9.72862, 16.17359090909091, 0.0, 0.0, 0.0, 0.0, 7.544709090909091, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
reward: -0.001367767469980754, done: False
<class 'stable_baselines3.common.vec_env.dummy_vec_env.DummyVecEnv'>
{'batch_size': 128, 'buffer_size': 1000000, 'learning_rate': 0.0001, 'learning_starts': 100, 'ent_coef': 'auto_0.1'}
Using cpu device
tcmalloc: large alloc 2204000256 bytes == 0x55e790e16000 @  0x7f913514b001 0x7f9132d0954f 0x7f9132d59b58 0x7f9132d5db17 0x7f9132dfc203 0x55e784e390e4 0x55e784e38de0 0x55e784ead6f5 0x55e784ea7e0d 0x55e784e3b02c 0x55e784e7bd39 0x55e784e78c84 0x55e784e398e9 0x55e784eadade 0x55e784e3a69a 0x55e784eace50 0x55e784ea7e0d 0x55e784e3a77a 0x55e784ea8c9e 0x55e784ea7e0d 0x55e784e3b02c 0x55e784e7bd39 0x55e784e78c84 0x55e784e3b231 0x55e784eaa1e6 0x55e784ea7b0e 0x55e784e3a77a 0x55e784ea986a 0x55e784ea7b0e 0x55e784ea7813 0x55e784f71592
tcmalloc: large alloc 2204000256 bytes == 0x55e8143fc000 @  0x7f913514b001 0x7f9132d0954f 0x7f9132d59b58 0x7f9132d5db17 0x7f9132dfc203 0x55e784e390e4 0x55e784e38de0 0x55e784ead6f5 0x55e784ea7e0d 0x55e784e3b02c 0x55e784e7bd39 0x55e784e78c84 0x55e784e398e9 0x55e784eadade 0x55e784e3a69a 0x55e784eace50 0x55e784ea7e0d 0x55e784e3a77a 0x55e784ea8c9e 0x55e784ea7e0d 0x55e784e3b02c 0x55e784e7bd39 0x55e784e78c84 0x55e784e3b231 0x55e784eaa1e6 0x55e784ea7b0e 0x55e784e3a77a 0x55e784ea986a 0x55e784ea7b0e 0x55e784ea7813 0x55e784f71592
2021-04-21 08:23:19.009409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
Logging to tensorboard_log/sac/sac_3
----------------------------------
| environment/        |          |
|    portfolio_value  | 3e+06    |
|    total_cost       | 7.78e+04 |
|    total_reward     | 2e+06    |
|    total_reward_pct | 200      |
|    total_trades     | 84094    |
| time/               |          |
|    episodes         | 4        |
|    fps              | 23       |
|    time_elapsed     | 416      |
|    total timesteps  | 9724     |
| train/              |          |
|    actor_loss       | 1.77e+03 |
|    critic_loss      | 282      |
|    ent_coef         | 0.184    |
|    ent_coef_loss    | -141     |
|    learning_rate    | 0.0001   |
|    n_updates        | 9623     |
----------------------------------
天数: 2430天, episode: 10
开始时的总资产: 1000000.0
结束时的总资产: 6252504.44
总奖励值: 5252504.44
总的手续费: 16431.17
总的交易次数: 68428
Sharpe: 0.615
=============================
----------------------------------
| environment/        |          |
|    portfolio_value  | 6.25e+06 |
|    total_cost       | 1.64e+04 |
|    total_reward     | 5.25e+06 |
|    total_reward_pct | 525      |
|    total_trades     | 68428    |
| time/               |          |
|    episodes         | 8        |
|    fps              | 22       |
|    time_elapsed     | 856      |
|    total timesteps  | 19448    |
| train/              |          |
|    actor_loss       | 832      |
|    critic_loss      | 165      |
|    ent_coef         | 0.0727   |
|    ent_coef_loss    | -205     |
|    learning_rate    | 0.0001   |
|    n_updates        | 19347    |
----------------------------------
----------------------------------
| environment/        |          |
|    portfolio_value  | 6.67e+06 |
|    total_cost       | 1.11e+04 |
|    total_reward     | 5.67e+06 |
|    total_reward_pct | 567      |
|    total_trades     | 63602    |
| time/               |          |
|    episodes         | 12       |
|    fps              | 22       |
|    time_elapsed     | 1297     |
|    total timesteps  | 29172    |
| train/              |          |
|    actor_loss       | 452      |
|    critic_loss      | 114      |
|    ent_coef         | 0.0278   |
|    ent_coef_loss    | -254     |
|    learning_rate    | 0.0001   |
|    n_updates        | 29071    |
----------------------------------
----------------------------------
| environment/        |          |
|    portfolio_value  | 5.96e+06 |
|    total_cost       | 6.59e+03 |
|    total_reward     | 4.96e+06 |
|    total_reward_pct | 496      |
|    total_trades     | 58541    |
| time/               |          |
|    episodes         | 16       |
|    fps              | 22       |
|    time_elapsed     | 1742     |
|    total timesteps  | 38896    |
| train/              |          |
|    actor_loss       | 246      |
|    critic_loss      | 36.3     |
|    ent_coef         | 0.0107   |
|    ent_coef_loss    | -260     |
|    learning_rate    | 0.0001   |
|    n_updates        | 38795    |
----------------------------------
天数: 2430天, episode: 20
开始时的总资产: 1000000.0
结束时的总资产: 5548280.15
总奖励值: 4548280.15
总的手续费: 4816.92
总的交易次数: 57532
Sharpe: 0.59
=============================
----------------------------------
| environment/        |          |
|    portfolio_value  | 5.29e+06 |
|    total_cost       | 4.48e+03 |
|    total_reward     | 4.29e+06 |
|    total_reward_pct | 429      |
|    total_trades     | 57755    |
| time/               |          |
|    episodes         | 20       |
|    fps              | 22       |
|    time_elapsed     | 2194     |
|    total timesteps  | 48620    |
| train/              |          |
|    actor_loss       | 153      |
|    critic_loss      | 3.46     |
|    ent_coef         | 0.00413  |
|    ent_coef_loss    | -261     |
|    learning_rate    | 0.0001   |
|    n_updates        | 48519    |
----------------------------------